(function(window){"use strict";var site=window.$ite={window:window,doc:window.document,body:window.document.body,params:{debug:false,trusted:false,sid:0,vid:0,aid:0,lang:"en",domain:""},utils:{onLoad:function(callback){document.addEventListener("DOMContentLoaded",callback)},loadScript:function(src,options){options=options||{};if(!src){return}var script=document.createElement('script');script.src=src;script.type='text/javascript';script.async=true;document.head.appendChild(script);if(options["onload"]){script.onload=options["onload"]}if(options["onerror"]){script.onerror=options["onerror"]}site.debug("Load script "+src)},addEvent:function(elem,evType,fn){if(elem.addEventListener){elem.addEventListener(evType,fn,false)}else if(elem.attachEvent){elem.attachEvent('on'+evType,fn)}}},start:function(params){this.params=params;if(!!site.window["site_debug"]||window.document.location.search.indexOf("profiling=")!==-1){this.params["debug"]=true}site.debug("Init site");for(var k in site){if(typeof site[k]==="object"&&site[k]["start"]&&typeof site[k]["start"]==="function"){try{site[k].start.call(site[k])}catch(e){site.error("Site start error:",e)}}}},hasParam:function(name){return!!this.params[name]},getParam:function(name){return this.params[name]||null},debug:function(){if(!!this.params["debug"]){var args=Array.from(arguments);args.unshift("<<DEBUG>>");window.console.log.apply(site.window,args)}},error:function(){var args=Array.from(arguments);args.unshift("<<ERROR>>");window.console.error.apply(site.window,args)}}})(window);(function(site){"use strict";var STATUS_NOT_LOADED=0;var STATUS_LOADING=1;var STATUS_LOADED=2;var captcha=site.captcha={STATUS_NOT_LOADED:STATUS_NOT_LOADED,STATUS_LOADING:STATUS_LOADING,STATUS_LOADED:STATUS_LOADED,scripts:{recaptcha:"https://www.google.com/recaptcha/api.js?onload=onReCaptchaLoad&render=explicit",mcaptcha:"//captcha.megagroup.ru/static/captcha.js?3.2",jquery:"/g/libs/jquery/3.2.1/jquery.min.js"},status:{recaptcha:0,mcaptcha:0},queue:{recaptcha:[],mcaptcha:[]},submit:false,ajax:window.XMLHttpRequest.prototype.send,ajax_force:false,ajax_data:[],count:0,badge:'badge-recaptcha',jquery_version:'',reData:null,isRendered:false,initEvents:['click','focus','touchstart','touchmove','scroll'],onMCaptchaLoad:function(){captcha.status.mcaptcha=STATUS_LOADED;site.debug("MCaptcha loaded");captcha.queue.mcaptcha.forEach(function(info){captcha.addMCaptcha(info)});captcha.queue.mcaptcha=[]},addReCaptcha:function(info){if(captcha.status.recaptcha===STATUS_LOADED){try{var $container=$(info.container),data={sitekey:info.sitekey,type:info.type,size:info.rsize,theme:info.theme},submit=false,form=$container.parents('form:first'),_form=form.get(0),sbmt=_form.submit,btns=form.find('button, [type=submit]'),is_anketa=form.find('[name^="d\["]').length,is_anketa2_api=false,is_post=form.attr('method')&&form.attr('method').toLowerCase()==='post',is_mosaic=form.hasClass('mosaic-form__form')||form.closest('[data-do-tt_form]').length||form.closest('[data-do-form]').length,action=form.attr('action')?form.attr('action'):'',is_product=action.indexOf('action=add')!==-1,is_maliver=action.indexOf('cp.maliver.ru')!==-1,is_init=form.data('recaptcha-init')===1,is_cart=action.indexOf('mode=cart')!==-1,click=false,events_status={},event_storage={},badge,el,onSubmit=function(token){if(token){form.find('[name="g-recaptcha-response"]').html(token)}if(!click&&(is_post||is_anketa||is_anketa2_api)){site.debug('submit event');if(!captcha.ajax_force){submit=true;try{site.debug('form submit for event');form.submit()}catch(e){site.debug('form js submit - no event',e);_form.submit()}}else{if(captcha.ajax_data[1][0].indexOf('&g-recaptcha-response=&')!==-1){captcha.ajax_data[1][0]=captcha.ajax_data[1][0].replace('&g-recaptcha-response=&',"&g-recaptcha-response="+token+'&',)}if(captcha.ajax_data[1][0].indexOf('&g-recaptcha-response=&')===-1&&captcha.ajax_data[1][0].endsWith('&g-recaptcha-response=')===true){captcha.ajax_data[1][0]+=token}if(captcha.ajax_data[1][0].indexOf('&g-recaptcha-response=&')===-1&&captcha.ajax_data[1][0].indexOf('&g-recaptcha-response=')===-1){captcha.ajax_data[1][0]+="&g-recaptcha-response="+token}captcha.ajax_force=false;site.debug('ajax apply in submit event');captcha.ajax.apply(captcha.ajax_data[0],captcha.ajax_data[1]);captcha.ajax_data=[]}}else if(click){click=false;site.debug('click event in submit');btns.each(function(k,_el){if(el===_el){$._data(_el).events.click.splice(0,$._data(_el).events.click.length);$._data(_el).events.click.push(...event_storage[k]);events_status[k]='on';$(el).trigger('click');events_manipulate()}})}getBadge().css('visibility','hidden')},onClick=function(){if(!click){el=this;click=true;site.debug('click event execute recaptcha');if(!captcha.isRendered){captcha.handleCLick()}grecaptcha.execute(getBadge().data('recaptcha-widget-id')).then(function(token){onSubmit(token)});return false}},onFocusin=function(){getBadge().css('visibility','visible')},onFocusout=function(){getBadge().css('visibility','hidden')},events_manipulate=function(){btns.each(function(k,el){if(typeof $._data(el).events.click!='undefined'){if(typeof events_status[k]=='undefined'||events_status[k]==='on'){$._data(el).events.click.forEach(function(data,i){if(typeof event_storage[k]=='undefined'){event_storage[k]=[]}event_storage[k][i]=$._data(el).events.click[i]});$._data(el).events.click.splice(0,$._data(el).events.click.length);$(el).on('click',onClick);events_status[k]='off'}}})},getBadge=function(){if(typeof badge=='undefined'){badge=$('#'+captcha.badge)}return badge};if($container.parents('[data-uri]:first').length&&$container.parents('[data-uri]:first').attr('data-uri').indexOf('method=form2/')!==-1||form.attr('data-s3-anketa-id')&&info.name==='_cn'){is_anketa2_api=true}$container.empty();if(!is_product&&!is_cart&&!is_init&&!is_maliver&&(is_post||(is_anketa||is_anketa2_api)&&!is_mosaic)){site.debug("Draw recaptcha in container",info.container);if(info.name==='recaptcha-page'){data['size']=4;data['callback']=onSubmit;$container.data('recaptcha-widget-id',grecaptcha.render(info.container,data))}else{_form.submit=function(){if(!submit){site.debug('js submit execute recaptcha');if(!captcha.isRendered){captcha.handleCLick()}grecaptcha.execute(getBadge().data('recaptcha-widget-id')).then(function(token){onSubmit(token)})}else{sbmt.apply(_form)}};if(captcha.getJqueryVersion()<10700){form.find('input,textarea,select').focus(onFocusin);form.find('input,textarea,select').blur(onFocusout);form.submit(function(){if(!submit){site.debug('old jquery submit execute recaptcha');if(!captcha.isRendered){captcha.handleCLick()}grecaptcha.execute(getBadge().data('recaptcha-widget-id')).then(function(token){onSubmit(token)});return false}})}else{form.find('input,textarea,select').on('focusin',onFocusin);form.find('input,textarea,select').on('focusout',onFocusout);form.on('submit',function(){if(!submit){site.debug('jquery submit execute recaptcha');if(!captcha.isRendered){captcha.handleCLick()}grecaptcha.execute(getBadge().data('recaptcha-widget-id')).then(function(token){onSubmit(token)});return false}});if(!is_post&&is_anketa){events_manipulate()}}$container.remove()}form.append('<textarea name="g-recaptcha-response" style="display: none !important;"></textarea>');form.data('recaptcha-init',1)}else if(!is_mosaic){$container.remove()}}catch(e){site.error("ReCaptcha error: ",e)}}else{captcha.queue.recaptcha.push(info)}},addMCaptcha:function(info){if(captcha.status.mcaptcha===STATUS_LOADED){var $container=$(info.container);var rand_id=Math.floor(Math.random()*10000);var container_id='s3_captcha_cn'+rand_id;var html='</br><input type="text" name="'+info.name+'" maxlength="'+info.msize+'" size="'+info.msize+'" />';$container.attr('id',container_id);try{site.debug("Draw mcaptcha in container",info.container);mgCaptcha.draw("/my/s3/captcha/get.php",container_id);$container.append(html)}catch(e){site.error("MCaptcha error:",e)}}else{if(captcha.status.mcaptcha===STATUS_NOT_LOADED){site.utils.loadScript(captcha.scripts.mcaptcha,{onload:function(){captcha.onMCaptchaLoad()}});captcha.status.mcaptcha=STATUS_LOADING}captcha.queue.mcaptcha.push(info)}},checker:function(){$("[data-captcha]").each(function(k,container){var $container=$(container);if($container.attr("data-captcha")==="recaptcha"){if($container.parents('form:first').length===0){site.debug("Not find parent form for ",$container);$container.remove()}else{site.debug("Init recaptcha by default for ",$container);captcha.addReCaptcha({sitekey:$container.attr("data-sitekey"),type:$container.attr("data-type"),rsize:$container.attr("data-rsize"),theme:$container.attr("data-theme"),lang:$container.attr("data-lang"),name:$container.attr("data-name"),container:container})}}else{site.debug("Init mcaptcha by default for ",$container);captcha.addMCaptcha({name:$container.attr("data-name"),msize:$container.attr("data-msize"),container:container})}$container.removeAttr("data-captcha")});if(captcha.queue.recaptcha.length&&site.doc.querySelector('[data-name=recaptcha-page]')&&captcha.status.recaptcha===STATUS_NOT_LOADED){site.doc.querySelector('[data-name=recaptcha-page]').click()}},start:function(){if(!site.window["$"]){var s=document.createElement("script");s.src=captcha.scripts.jquery;s.async=true;s.onload=function(){captcha.load()};document.getElementsByTagName("head")[0].appendChild(s)}else{captcha.load()}},handleCLick:function(){if(captcha.queue.recaptcha.length&&captcha.status.recaptcha===STATUS_NOT_LOADED){site.utils.loadScript(captcha.scripts.recaptcha+"&hl="+site.getParam("lang"),{onerror:function(e){site.error("ReCaptcha load error: ",e)}});captcha.status.recaptcha=STATUS_LOADING}},load:function(){window.XMLHttpRequest.prototype.send=function(){try{if(!arguments[0]){site.debug('ajax get');captcha.ajax.apply(this,[].slice.call(arguments))}else{var params=arguments[0],is_recaptcha=params.indexOf('g-recaptcha-response=')!==-1,error=false;if(is_recaptcha){params.split('&').forEach(function(v){if(v.indexOf('g-recaptcha-response=')!==-1){v=v.split('=');if(v.length>1&&v[1]<1||v.length===1||/[а-яА-ЯЁё]/.test(decodeURI(v[1]))){error=true}}});if(error&&!captcha.ajax_force){captcha.ajax_force=true;captcha.ajax_data=[this,arguments];site.debug('ajax stop post - recaptcha error')}else{captcha.ajax_data=[];captcha.ajax_force=false;site.debug('ajax post, no recaptcha error');captcha.ajax.apply(this,[].slice.call(arguments))}}else{site.debug('ajax post, no recaptcha');captcha.ajax.apply(this,[].slice.call(arguments))}}}catch(e){site.debug('ajax manipulate error, send',e);captcha.ajax.apply(this,[].slice.call(arguments))}};setInterval(function(){try{captcha.checker()}catch(e){site.error("Captcha checker:",e)}},300);captcha.initEvents.forEach(event=>{site.doc.addEventListener(event,captcha.handleCLick,true)})},init:function(){captcha.reData={sitekey:captcha.queue.recaptcha[0].sitekey,type:captcha.queue.recaptcha[0].type,size:captcha.queue.recaptcha[0].rsize,theme:captcha.queue.recaptcha[0].theme};$('body').append(`<div id="${captcha.badge}"style="visibility: hidden;"></div>`);if(!captcha.isRendered){captcha.render()}},render:function(){$(`#${captcha.badge}`).data('recaptcha-widget-id',grecaptcha.render(captcha.badge,captcha.reData));captcha.isRendered=true},getJqueryVersion:function(){if(captcha.jquery_version===''){var tmp=jQuery.fn.jquery.split('.');tmp.forEach(function(val){if(val.length===1){captcha.jquery_version=captcha.jquery_version.concat(0)}captcha.jquery_version=captcha.jquery_version.concat(val)});captcha.jquery_version=parseInt(captcha.jquery_version)}return captcha.jquery_version},checkJqueryVersion:function(compare,version){}};site.window.onReCaptchaLoad=function(){site.window.dispatchEvent(new Event('ReCaptchaLoaded'));captcha.status.recaptcha=STATUS_LOADED;site.debug("Recaptcha loaded");captcha.initEvents.forEach(event=>{site.doc.removeEventListener(event,captcha.handleCLick)});captcha.init();captcha.queue.recaptcha.forEach(function(info){captcha.addReCaptcha(info)});site.captcha.queue.recaptcha=[]}})(window.$ite);(function(site){"use strict";site.hotkeys={start:function(){if(site.getParam("trusted")){site.utils.addEvent(window.document,"keydown",function(e){if(e['altKey']&&e.keyCode===80){if(location.search.indexOf("profiling")===-1){if(location.search.indexOf("?")===-1){location.search+="?profiling="+Math.round(Math.random()*100000)}else{location.search+="&profiling="+Math.round(Math.random()*100000)}}}if(e['altKey']&&e.keyCode===79&&site.hasParam("domain")&&site.hasParam("vid")&&site.hasParam("aid")){site.window.open(window.atob("aHR0cDovLw==")+site.getParam("domain")+window.atob("L215L3MzL2RhdGEvbWVudS9kZWZhdWx0LnBocD9tY2E9")+site.getParam("aid")+window.atob("Jm1jcz0xJnZlcl9pZD0=")+site.getParam("vid"))}})}}}})(window.$ite);(function(site){"use strict";var feedback=site.feedback={factory:null,start:function(){site.utils.loadScript("/shared/feedback/feedback.factory.js",{onload:function(){feedback.factory=site.window.FeedbackFactory;site.feedback.factoryStart()}})},factoryStart:function(){feedback.factory.setOption('sources','/shared/feedback');feedback.factory.setOption('url',site.window.atob('L215L3MzL2ZlZWRiYWNrL3JlcG9ydC5waHA='));feedback.factory.setData('instance_id',site.getParam('aid'));feedback.factory.addScript(site.window.atob("aHR0cHM6Ly9jYWJpbmV0Lm1lZ2Fncm91cC5ydS9jbGllbnQuanNvbnA/Y2FsbGJhY2s9")+"setFeedbackUserId")}};site.window.setFeedbackUserId=function(data){if(data.id){feedback.factory.setData('user_id',data.id)}}})(window.$ite);